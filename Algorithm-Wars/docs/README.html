<h1 id="investment-strategies-library-algo-wars">Investment Strategies
Library: algo-wars</h1>
<p><code>algo-wars</code> is Python library for Investment Strategies
such as Volatility Modeling, Technical Analysis, and Portfolio
Optimization. The goal of this library is to provides cues for
strategies to investment or trade stock, bond, or cryptocurrency, based
on the statistical machine learning and the deep reignforcement
learning. Especialy, this library provides apprication of the Volatility
model based on Conditional Generative Adversarial Networks(Conditional
GANs) and Portfolio Selection based on Deep Q-Network.</p>
<p>Please do note that this library is currently in <em>BETA</em>
Testing. Please use this library <strong>at your own risk</strong>.</p>
<h2 id="installation">Installation</h2>
<p>Install using pip:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install algo-wars</span></code></pre></div>
<h3 id="source-code">Source code</h3>
<p>The source code is currently hosted on GitHub.</p>
<ul>
<li><a
href="https://github.com/accel-brain/accel-brain-code/tree/master/Algorithm-Wars">accel-brain-code/Algorithm-Wars</a></li>
</ul>
<h3 id="python-package-indexpypi">Python package index(PyPI)</h3>
<p>Installers for the latest released version are available at the
Python package index.</p>
<ul>
<li><a href="https://pypi.org/pypi/algo-wars/">algo-wars : Python
Package Index</a></li>
</ul>
<h3 id="dependencies">Dependencies</h3>
<ul>
<li><a href="https://github.com/numpy/numpy">numpy</a>: v1.13.3 or
higher.</li>
<li><a href="https://github.com/pandas-dev/pandas">pandas</a>: v0.22.0
or higher.</li>
<li><a
href="https://github.com/accel-brain/accel-brain-code/tree/master/Accel-Brain-Base">accel-brain-base</a>:
v1.0.0 or higher.</li>
</ul>
<h4 id="options">Options</h4>
<ul>
<li><a href="https://github.com/ranaroussi/yfinance">yfinance</a>
<ul>
<li>Only when using <a
href="https://github.com/accel-brain/accel-brain-code/blob/master/Algorithm-Wars/algowars/extractablehistoricaldata/facade_yfinance.py">algowars/extractablehistoricaldata/facade_yfinance.py</a>.</li>
</ul></li>
</ul>
<!--
## Documentation

Full documentation is available on [https://code.accel-brain.com/Algorithm-Wars/](https://code.accel-brain.com/Algorithm-Wars/) . This document contains information on functionally reusability, functional scalability and functional extensibility.
-->
<h2 id="description">Description</h2>
<p>The library is designing a complex of two deep architectures:</p>
<ol type="1">
<li>Generative Adversarial Networks(GAN) that enable the generation of
pseudo-historical data.</li>
<li>Multi-agent Deep Reinforcement Learning(Multi-agent DRL) that
addresses multiple investment strategies such as volatility minimization
and Sharpe ratio maximization.</li>
</ol>
<p>For convenience, we named this complex system <em>Adversarial
Generative Deep Reinforcement Learning</em>.</p>
<p>Multi-agent DRL can acquire high generalization performance and
domain adaptability by learning both the historical data generated by
GAN and the true historical data. Multi-agent DRL develops a solution
under two problem settings: volatility minimization and Sharpe ratio
maximization. Multiple agents are assigned to each problem setting.
Finally, the portfolio of agents with the highest cost performance is
output as the winning portfolio.</p>
<p>This library uses Retrospective encoders from Zhang, K., et
al. (2018) as generative models in designing GANs for modeling
volatility. This model is also mentioned in <a
href="https://github.com/accel-brain/accel-brain-code/tree/master/Automatic-Summarization">Automatic
Summarization Library: pysummarization</a>. The loss/error function and
network structure are designed according to Akcay, S., et al. (2018). As
used in <a
href="https://github.com/accel-brain/accel-brain-code/tree/master/Generative-Adversarial-Networks">Generative
Adversarial Networks Library: pygan</a>, This model facilitates manifold
learning by adding a re-encoder to the encoder-decoder network
structure.</p>
<p>The Multi-agent DRL is designed as a Deep Q-network derived from the
decentralized partially observable Markov decision process(Dec-POMDP)
proposed by Egorov, M. (2016). This model is also mentioned in <a
href="https://github.com/accel-brain/accel-brain-code/tree/master/Reinforcement-Learning">Reinforcement
Learning Library: pyqlearning</a>.</p>
<h3 id="setup-master-data-of-ticker-symbols.">Setup master data of
ticker symbols.</h3>
<p>Before starting learning, it is necessary to prepare the master data
of securities. Demo data is located in <a
href="https://github.com/accel-brain/accel-brain-code/blob/master/Algorithm-Wars/masterdata/ticker_master_demo.csv">masterdata/ticker_master_demo.csv</a>.
This master data is referred to during data preparation and
learning.</p>
<p>The column definition is as follows.</p>
<ul>
<li><code>ticker</code>: Ticker Symbol.</li>
<li><code>asset</code>: Asset type.</li>
<li><code>area</code>: If the asset has regionality, write a symbol such
as the category.
<ul>
<li>If it’s a US stock, for instance, write <code>US</code>.</li>
</ul></li>
<li><code>detail</code>: It’s just a space for notes. The system does
not refer to this value.</li>
<li><code>asset_allocation</code>: Weight per asset. This value is
referenced when calculating the portfolio percentage.
<ul>
<li>If you want to judge purely by the algorithm, write a constant
here.</li>
</ul></li>
<li><code>area_allocation</code>: Weight per area. This value is
referenced when calculating the portfolio percentage.
<ul>
<li>If you want to judge purely by the algorithm, write a constant
here.</li>
</ul></li>
<li><code>expense_ratio</code>: ETF expense ratio. Write
<code>0.0</code> for individual stocks and crypto assets.</li>
<li><code>yield</code>: Past annual yield.</li>
<li><code>commission</code>: Trading fees.</li>
<li><code>tax</code>: Tax rate on capital gains.</li>
</ul>
<h3 id="data-preparation">Data Preparation</h3>
<p>Historical data must be placed in the
<code>logs / historical /</code> directory as a CSV file consisting of
the following formats:</p>
<ul>
<li><code>timestamp</code>: <code>YYYY-MM-DD</code></li>
<li><code>open</code>: open.</li>
<li><code>high</code>: high.</li>
<li><code>low</code>: low.</li>
<li><code>close</code>: close.</li>
<li><code>adjusted_close</code>: adjusted close.</li>
<li><code>volume</code>: volume.</li>
</ul>
<p>It is necessary to prepare one CSV file for each Ticker symbols.
Also, the file name must be associated with the value in the
<code>ticker</code> column in the security master data.</p>
<p>Historical data can be obtained from various REST (ful) APIs. This
library already has a batch program for retrieving data from several
APIs. For instance,</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> algowars/extractablehistoricaldata/facade_yfinance.py <span class="dt">\</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>-v True <span class="dt">\</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>-tmp ./masterdata/ticker_master_demo.csv</span></code></pre></div>
<p>Learning and inference can be performed from the following batch
programs.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> algowars/portfolio_dqn_controller.py <span class="dt">\</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>-v True <span class="dt">\</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>-sd 2013-06-24 <span class="at">-ed</span> 2020-06-23 <span class="dt">\</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>-gsd 2021-01-01 <span class="at">-ged</span> 2021-04-27 <span class="dt">\</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>-df 30 <span class="dt">\</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>-an 3 <span class="dt">\</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>-ep 300 <span class="dt">\</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>-nan 3 <span class="dt">\</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>-lrdqn 1e-04 <span class="at">-lr</span> 1e-10 <span class="dt">\</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>-in 500 <span class="dt">\</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>-bs 20 <span class="dt">\</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>-sl 10  <span class="dt">\</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>-rpm 1.0 <span class="dt">\</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>-rps 0.1 <span class="dt">\</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>-gpp params/recursive_seq_2_seq_model_re_encoder_model.params <span class="dt">\</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>-rpp params/recursive_seq_2_seq_model_model.params <span class="dt">\</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>-dpp params/discriminative_model_model.params <span class="dt">\</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>-dqnpp params/dqn_model.params <span class="dt">\</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>-tmp masterdata/ticker_master_demo.csv <span class="dt">\</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>-sc all <span class="dt">\</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>-mm 120000 <span class="dt">\</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>-mfm <span class="dt">\</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>-ltsl 90</span></code></pre></div>
<p>You can check the interface specifications of the batch program with
the following command.</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> algowars/portfolio_dqn_controller.py <span class="at">-h</span></span></code></pre></div>
<p>A demonstration of visualizing the results of pseudo-historical data
generation and portfolio optimization is demonstrated in the following
notebook.</p>
<ul>
<li><a
href="https://github.com/accel-brain/accel-brain-code/blob/master/Algorithm-Wars/demo-portfolio-optimization.ipynb">demo-portfolio-optimization.ipynb</a></li>
</ul>
<h2 id="references">References</h2>
<p>The basic concepts, theories, and methods behind this library are
described in the following books.</p>
<div data-align="center">
<a href="https://www.amazon.co.jp/dp/B08PV4ZQG5/" target="_blank"><img src="https://storage.googleapis.com/accel-brain-code/Accel-Brain-Books/In-house_R_and_D_in_the_era_of_democratization_of_AI/book_cover.jpg" width="160px" /></a>
<p>
『<a href="https://www.amazon.co.jp/dp/B08PV4ZQG5/ref=sr_1_1?dchild=1&qid=1607343553&s=digital-text&sr=1-1&text=%E6%A0%AA%E5%BC%8F%E4%BC%9A%E7%A4%BEAccel+Brain" target="_blank">「AIの民主化」時代の企業内研究開発:
深層学習の「実学」としての機能分析</a>』(Japanese)
</p>
</div>
<p><br /></p>
<div data-align="center">
<a href="https://www.amazon.co.jp/dp/B093Z533LK" target="_blank"><img src="https://storage.googleapis.com/accel-brain-code/Accel-Brain-Books/AI_vs_Investors_as_Noise_Traders/book_cover.jpg" width="160px" /></a>
<p>
『<a href="https://www.amazon.co.jp/dp/B093Z533LK" target="_blank">AI
vs. ノイズトレーダーとしての投資家たち:
「アルゴリズム戦争」時代の証券投資戦略</a>』(Japanese)
</p>
</div>
<p><br /></p>
<div data-align="center">
<a href="https://www.amazon.co.jp/dp/B0994CH3CM" target="_blank"><img src="https://storage.googleapis.com/accel-brain-code/Accel-Brain-Books/Babel_of_Natural_Language_Processing/book_cover.jpg" width="160px" /></a>
<p>
『<a href="https://www.amazon.co.jp/dp/B0994CH3CM" target="_blank">自然言語処理のバベル:
文書自動要約、文章生成AI、チャットボットの意味論</a>』(Japanese)
</p>
</div>
<p><br /></p>
<div data-align="center">
<a href="https://www.amazon.co.jp/dp/B09C4KYZBX" target="_blank"><img src="https://storage.googleapis.com/accel-brain-code/Accel-Brain-Books/Origin_of_the_statistical_machine_learning/book_cover.jpg" width="160px" /></a>
<p>
『<a href="https://www.amazon.co.jp/dp/B09C4KYZBX" target="_blank">統計的機械学習の根源:
熱力学、量子力学、統計力学における天才物理学者たちの神学的な理念</a>』(Japanese)
</p>
</div>
<p><br /></p>
<div data-align="center">
<a href="https://www.amazon.co.jp/dp/B09JC4Z7B4" target="_blank"><img border="0" src="https://storage.googleapis.com/accel-brain-code/Accel-Brain-Books/Media_Aesthetics_of_Data_Visualization/book_cover.jpg" width="160px"></a>
 
<p>
『<a href="https://www.amazon.co.jp/dp/B09JC4Z7B4" target="_blank">データビジュアライゼーションのメディア美学:
ハイブリッド戦略の魔術師たち</a>』(Japanese)
</p>
</div>
<p>Specific references are the following papers and books.</p>
<ul>
<li>Akcay, S., Atapour-Abarghouei, A., &amp; Breckon, T. P. (2018,
December). Ganomaly: Semi-supervised anomaly detection via adversarial
training. In Asian Conference on Computer Vision (pp. 622-637).
Springer, Cham.</li>
<li>Donahue, J., Krähenbühl, P., &amp; Darrell, T. (2016). Adversarial
feature learning. arXiv preprint arXiv:1605.09782.</li>
<li>Makhzani, A., Shlens, J., Jaitly, N., Goodfellow, I., &amp; Frey, B.
(2015). Adversarial autoencoders. arXiv preprint arXiv:1511.05644.</li>
<li>Salimans, T., Goodfellow, I., Zaremba, W., Cheung, V., Radford, A.,
&amp; Chen, X. (2016). Improved techniques for training gans. In
Advances in neural information processing systems (pp. 2234-2242).</li>
<li>Schlegl, T., Seeböck, P., Waldstein, S. M., Schmidt-Erfurth, U.,
&amp; Langs, G. (2017, June). Unsupervised anomaly detection with
generative adversarial networks to guide marker discovery. In
International conference on information processing in medical imaging
(pp. 146-157). Springer, Cham.</li>
<li>Yeh, R., Chen, C., Lim, T. Y., Hasegawa-Johnson, M., &amp; Do, M. N.
(2016). Semantic image inpainting with perceptual and contextual losses.
arXiv preprint arXiv:1607.07539, 2(3).</li>
<li>Zenati, H., Foo, C. S., Lecouat, B., Manek, G., &amp; Chandrasekhar,
V. R. (2018). Efficient gan-based anomaly detection. arXiv preprint
arXiv:1802.06222.</li>
<li>Zhang, K., Grauman, K., &amp; Sha, F. (2018). Retrospective Encoders
for Video Summarization. In Proceedings of the European Conference on
Computer Vision (ECCV) (pp. 383-399).</li>
</ul>
<h2 id="author">Author</h2>
<ul>
<li>accel-brain</li>
</ul>
<h2 id="author-uri">Author URI</h2>
<ul>
<li>https://accel-brain.co.jp/</li>
<li>https://accel-brain.com/</li>
</ul>
<h2 id="license">License</h2>
<ul>
<li>GNU General Public License v2.0</li>
</ul>
